# flutter_native_certs_example

Demonstrates how to use the flutter_native_certs plugin.

## Getting Started
There are several steps needed in order to verify that a certain client trusts specific user installed SSL certificates.

### Generate Self-Signed SSL Certificates
Custom self-signed certificates can be generated by running the `./generate_certificates.sh` script from the `/example` directory.
A functioning installation of [OpenSSL](https://www.openssl.org/) is required for running the script.

### Start the HTTPS Server
A simple server which uses the previously generated certificates is located in `server/bin/server.dart`.

In order to start it from the `/example` directory, open a new terminal there and run:
```bash
dart run server/bin/server.dart
```

### Android
Describes how to check whether the custom certificate is trusted on Android.

#### Emulator
1. Start the example app in the Android emulator using `flutter run`
2. Verify that the certificate is not trusted by entering `https://10.0.2.2:8080` as the **Endpoint URL** and tapping the *Send TLS Request* button
3. Drag the `root.crt` [certificate authority](https://en.wikipedia.org/wiki/Certificate_authority) generated before starting the server into the Android emulator (`root.crt` should be located in `Downloads` now)
3. Install the *Root CA* by navigating to `Settings` → `Security & privacy` → `More security & privacy` → `Encryption & credentials` → `Install a certificate` → `CA certificate` and then selecting the `root.crt` file from downloads (depending on your specific Android version, the appropriate setting may be located elsewhere)
4. The request to `https://10.0.2.2:8080` should now succeed after restarting the app via `flutter run` and then tapping the *Send TLS Request* button
5. You can verify that the [default `SecurityContext`](https://api.flutter.dev/flutter/dart-io/SecurityContext/defaultContext.html) still does not consider the newly installed certificate using the *Send with default SecurityContext* button

#### Physical Device
Make sure that the PC on which the server started in the section above runs on is on the same network as the Android device.
Then copy the `root.crt` to the device (for example via USB) and install it as described in the *emulator* section.
The remaining steps are the same as with the emulator.

### Logging Trusted Certificates
In debug mode it is possible to log all currently trusted certificates like this:
```bash
flutter run --dart-define=LOG_TRUSTED_CERTIFICATES=true
```

For security purposes this must be enabled explicitly via a
[compile-time environment variable](https://dart.dev/libraries/core/environment-declarations)
and is only available in debug mode.